---
- name: AgoraElections, Start postgresql
  sudo: true
  service: name=postgresql state=started

- name: AgoraElections, Create Database User
  sudo: true
  sudo_user: postgres
  when: config.load_balancing.is_master
  postgresql_user: user=agora_elections password="{{config.agora_elections.db_password}}" port=5432

- name: AgoraElections, Create Database
  sudo: true
  sudo_user: postgres
  when: config.load_balancing.is_master
  postgresql_db:
    name=agora_elections
    owner=agora_elections
    encoding="utf-8"
    lc_collate='en_US.UTF-8'
    lc_ctype='en_US.UTF-8'
    template='template0'
    state=present
