---
- name: EOrchestra, creating commands
  sudo: true
  template: src=eorchestra/templates/commands/{{item.script}} dest={{ item.dest }} owner={{ item.owner }} mode={{ item.mode }}
  with_items:
    - { script: backup_password, dest: /root/.backup_password, owner: "root", mode: "0600" }
    - { script: create_backup.sh, dest: /usr/bin/create_backup.sh, owner: "root", mode: "0755" }
    - { script: restore_backup.sh, dest: /usr/bin/restore_backup.sh, owner: "root", mode: "0755" }
    - { script: reset-tally, dest: /usr/bin/reset-tally, owner: "root", mode: "0755" }
    - { script: eolog, dest: /usr/bin/eolog, owner: "root", mode: "0755" }
    - { script: eoauto, dest: /usr/bin/eoauto, owner: "root", mode: "0755" }
    - { script: vmnd.sh, dest: /usr/bin/vmnd.sh, owner: "root", mode: "0755" }

- name: EOrchestra, creating /srv/eotests
  sudo: true
  file: path="/srv/eotests" owner="eorchestra" group="users" state=directory

- name: EOrchestra, creating /srv/eotests/encrypt-deps
  sudo: true
  file: path="/srv/eotests/encrypt-deps" owner="eorchestra" group="users" state=directory

- name: EOrchestra, encrypt.js deps
  sudo: true
  get_url: url={{ item }} dest=/srv/eotests/encrypt-deps/ validate_certs={{ not config.has_https_proxy }}
  with_items:
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/jsbn.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/jsbn2.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/bigint.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/class.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/elgamal.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/random.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/sha1.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/sha2.js
    - https://github.com/agoravoting/agora-gui-booth/raw/master/vendor/crypto/sjcl.js
    - http://momentjs.com/downloads/moment.js

- name: EOrchestra, encrypt.js
  sudo: true
  template: src=eorchestra/templates/commands/encrypt.js dest=/srv/eotests/encrypt.js owner=root mode=0755
